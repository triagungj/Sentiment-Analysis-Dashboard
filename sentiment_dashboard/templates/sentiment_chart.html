<!DOCTYPE html>
<html>
  <head>
    <title>Sentiment Chart</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>
  <body>
    <h2>Sentiment Statistics Per Month</h2>
    <canvas id="sentimentChart" width="800" height="400"></canvas>
    <script>
      fetch("/api/dashboard/sentiment-stats/")
        .then((response) => response.json())
        .then((data) => {
          const labels = data.map((item) => {
            const [year, month] = item.date.split("-");
            return `${year}-${month}`;
          });
          const positive = data.map((item) => item.positive);
          const neutral = data.map((item) => item.neutral);
          const negative = data.map((item) => item.negative);

          const ctx = document
            .getElementById("sentimentChart")
            .getContext("2d");
          new Chart(ctx, {
            type: "line",
            data: {
              labels: labels,
              datasets: [
                {
                  label: "Positive",
                  data: positive,
                  borderColor: "rgba(40, 167, 69, 1)",
                  backgroundColor: "rgba(40, 167, 69, 0.2)",
                  fill: false,
                  tension: 0.3,
                  pointRadius: 2,
                },
                {
                  label: "Neutral",
                  data: neutral,
                  borderColor: "rgba(108, 117, 125, 1)",
                  backgroundColor: "rgba(108, 117, 125, 0.2)",
                  fill: false,
                  tension: 0.3,
                  pointRadius: 2,
                },
                {
                  label: "Negative",
                  data: negative,
                  borderColor: "rgba(220, 53, 69, 1)",
                  backgroundColor: "rgba(220, 53, 69, 0.2)",
                  fill: false,
                  tension: 0.3,
                  pointRadius: 2,
                },
              ],
            },
            options: {
              responsive: true,
              plugins: {
                legend: {
                  labels: {
                    color: "#343a40",
                    font: {
                      size: 16,
                      family: "Helvetica Neue, Arial, sans-serif",
                      weight: "bold",
                    },
                  },
                },
              },
              scales: {
                x: {
                  title: {
                    display: true,
                    text: "Month",
                    color: "#343a40",
                    font: { size: 14 },
                  },
                },
                y: {
                  beginAtZero: true,
                  title: {
                    display: true,
                    text: "Count",
                    color: "#343a40",
                    font: { size: 14 },
                  },
                },
              },
            },
          });
        });
    </script>
  </body>
</html>
